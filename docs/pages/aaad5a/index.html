<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>锁 | 知识导图</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/images/logo.PNG">
    <meta name="description" content="复杂的知识体系需要一套精简的知识导图作参考和索引">
    
    <link rel="preload" href="/assets/css/0.styles.f55df645.css" as="style"><link rel="preload" href="/assets/js/app.0f5508c3.js" as="script"><link rel="preload" href="/assets/js/2.d54d51d6.js" as="script"><link rel="preload" href="/assets/js/27.d36d4f39.js" as="script"><link rel="prefetch" href="/assets/js/10.e7c89723.js"><link rel="prefetch" href="/assets/js/11.47990fdb.js"><link rel="prefetch" href="/assets/js/12.cc347e95.js"><link rel="prefetch" href="/assets/js/13.8d97213a.js"><link rel="prefetch" href="/assets/js/14.0f8676d0.js"><link rel="prefetch" href="/assets/js/15.b52f0b68.js"><link rel="prefetch" href="/assets/js/16.7fede778.js"><link rel="prefetch" href="/assets/js/17.80285da6.js"><link rel="prefetch" href="/assets/js/18.ff5f3914.js"><link rel="prefetch" href="/assets/js/19.b6dc623f.js"><link rel="prefetch" href="/assets/js/20.6055ae71.js"><link rel="prefetch" href="/assets/js/21.32a535b7.js"><link rel="prefetch" href="/assets/js/22.04e4ee27.js"><link rel="prefetch" href="/assets/js/23.e0157db1.js"><link rel="prefetch" href="/assets/js/24.02871e36.js"><link rel="prefetch" href="/assets/js/25.632d40b8.js"><link rel="prefetch" href="/assets/js/26.8c118520.js"><link rel="prefetch" href="/assets/js/28.a5f5f4a0.js"><link rel="prefetch" href="/assets/js/29.8d985ecc.js"><link rel="prefetch" href="/assets/js/3.1c8f89f8.js"><link rel="prefetch" href="/assets/js/30.2359990d.js"><link rel="prefetch" href="/assets/js/31.6d01554f.js"><link rel="prefetch" href="/assets/js/32.16c8c522.js"><link rel="prefetch" href="/assets/js/33.de312e92.js"><link rel="prefetch" href="/assets/js/34.9c29686a.js"><link rel="prefetch" href="/assets/js/35.7ccb1f3f.js"><link rel="prefetch" href="/assets/js/36.1db1b18e.js"><link rel="prefetch" href="/assets/js/37.9108243e.js"><link rel="prefetch" href="/assets/js/38.4ca50422.js"><link rel="prefetch" href="/assets/js/39.50e77631.js"><link rel="prefetch" href="/assets/js/4.dd3209f8.js"><link rel="prefetch" href="/assets/js/40.2ed6fea1.js"><link rel="prefetch" href="/assets/js/41.e409439d.js"><link rel="prefetch" href="/assets/js/42.16def890.js"><link rel="prefetch" href="/assets/js/43.a4945833.js"><link rel="prefetch" href="/assets/js/44.93004fe0.js"><link rel="prefetch" href="/assets/js/45.1bdca865.js"><link rel="prefetch" href="/assets/js/46.cf985d03.js"><link rel="prefetch" href="/assets/js/47.f14700e2.js"><link rel="prefetch" href="/assets/js/48.5060e89a.js"><link rel="prefetch" href="/assets/js/49.7327a141.js"><link rel="prefetch" href="/assets/js/5.d0fcbd61.js"><link rel="prefetch" href="/assets/js/50.a111f55b.js"><link rel="prefetch" href="/assets/js/51.3294caec.js"><link rel="prefetch" href="/assets/js/52.1e7af1dc.js"><link rel="prefetch" href="/assets/js/53.5e3f213e.js"><link rel="prefetch" href="/assets/js/54.df84ef0f.js"><link rel="prefetch" href="/assets/js/55.b4365d4b.js"><link rel="prefetch" href="/assets/js/56.0c265085.js"><link rel="prefetch" href="/assets/js/57.b4e0c82c.js"><link rel="prefetch" href="/assets/js/58.37b13db6.js"><link rel="prefetch" href="/assets/js/59.7dd915bd.js"><link rel="prefetch" href="/assets/js/6.a33f551b.js"><link rel="prefetch" href="/assets/js/60.497c25b6.js"><link rel="prefetch" href="/assets/js/61.dcd8f1e0.js"><link rel="prefetch" href="/assets/js/62.6a35ac3b.js"><link rel="prefetch" href="/assets/js/63.cda4a1d5.js"><link rel="prefetch" href="/assets/js/64.31714efc.js"><link rel="prefetch" href="/assets/js/65.73d288ae.js"><link rel="prefetch" href="/assets/js/66.648c0aa9.js"><link rel="prefetch" href="/assets/js/67.5ea43d4c.js"><link rel="prefetch" href="/assets/js/68.82a69bd5.js"><link rel="prefetch" href="/assets/js/69.696d3153.js"><link rel="prefetch" href="/assets/js/7.e750887e.js"><link rel="prefetch" href="/assets/js/70.b93396fa.js"><link rel="prefetch" href="/assets/js/71.86fc566c.js"><link rel="prefetch" href="/assets/js/72.47deaa0b.js"><link rel="prefetch" href="/assets/js/73.23e4612a.js"><link rel="prefetch" href="/assets/js/74.7a12384e.js"><link rel="prefetch" href="/assets/js/75.884cc56f.js"><link rel="prefetch" href="/assets/js/76.47df7e53.js"><link rel="prefetch" href="/assets/js/77.0b510281.js"><link rel="prefetch" href="/assets/js/78.436da846.js"><link rel="prefetch" href="/assets/js/79.47e87a79.js"><link rel="prefetch" href="/assets/js/8.6b31862c.js"><link rel="prefetch" href="/assets/js/80.489bdee8.js"><link rel="prefetch" href="/assets/js/81.f77033fd.js"><link rel="prefetch" href="/assets/js/82.a6215e2e.js"><link rel="prefetch" href="/assets/js/83.7a13f903.js"><link rel="prefetch" href="/assets/js/84.5d2f2f6d.js"><link rel="prefetch" href="/assets/js/85.173138d2.js"><link rel="prefetch" href="/assets/js/86.f1971f8f.js"><link rel="prefetch" href="/assets/js/87.53b8e651.js"><link rel="prefetch" href="/assets/js/9.ca81a571.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f55df645.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo.PNG" alt="知识导图" class="logo"> <span class="site-name can-hide">知识导图</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/3468b2/" class="nav-link">iOS知识</a></div><div class="nav-item"><a href="/pages/603316/" class="nav-link">计算机软件</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接" class="dropdown-title"><!----> <span class="title" style="display:;">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.52im.net/index.php" target="_blank" rel="noopener noreferrer" class="nav-link external">
  即时通讯网
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zhuanlan.zhihu.com/p/409277420" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开发常用网站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/3468b2/" class="nav-link">iOS知识</a></div><div class="nav-item"><a href="/pages/603316/" class="nav-link">计算机软件</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接" class="dropdown-title"><!----> <span class="title" style="display:;">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.52im.net/index.php" target="_blank" rel="noopener noreferrer" class="nav-link external">
  即时通讯网
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zhuanlan.zhihu.com/p/409277420" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开发常用网站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS开发-上篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>iOS开发-中篇</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/1a2531/" class="sidebar-link">KVO</a></li><li><a href="/pages/a8479d/" class="sidebar-link">Block</a></li><li><a href="/pages/be70e9/" class="sidebar-link">GCD</a></li><li><a href="/pages/f56bb5/" class="sidebar-link">NSNotification</a></li><li><a href="/pages/e01d5e/" class="sidebar-link">Delegate</a></li><li><a href="/pages/c0a875/" class="sidebar-link">Socket</a></li><li><a href="/pages/44385c/" class="sidebar-link">随笔</a></li><li><a href="/pages/ce0242/" class="sidebar-link">Bug收集分析</a></li><li><a href="/pages/1b1e3b/" class="sidebar-link">内存</a></li><li><a href="/pages/073276/" class="sidebar-link">内存管理</a></li><li><a href="/pages/aaad5a/" aria-current="page" class="active sidebar-link">锁</a></li><li><a href="/pages/2e933e/" class="sidebar-link">多线程-锁</a></li><li><a href="/pages/4c1594/" class="sidebar-link">数据库多线程</a></li><li><a href="/pages/4abadf/" class="sidebar-link">数据存储</a></li><li><a href="/pages/59f72f/" class="sidebar-link">响应链</a></li><li><a href="/pages/b72c04/" class="sidebar-link">设计模式</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS开发-下篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS开发-三方库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS开发-工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>iOS开发</span></li><li data-v-06225672><span data-v-06225672>iOS开发-中篇</span></li></ul> <div class="info" data-v-06225672><!----> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-05-14</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><!----> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">锁<!----></h1> <!----> <div class="theme-vdoing-content content__default"><html><head><meta charset="utf-8"> <meta content="IE=edge" http-equiv="X-UA-Compatible"> <title>iOS开发-上篇-2022</title> <style>
        body{
            margin: 0;
        }
        #content-info{
            width: auto;
            margin: 0 auto;
            text-align: center;
        }
        #author-info{
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
        #title{
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
            padding-top: 10px;
            margin-bottom: 2px;
            font-size: 34px;
            color: #505050;
        }
        .text{
            white-space:nowrap;
            text-overflow: ellipsis;
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 2px;
            font-size: 20px;
            color: #8c8c8c;
        }
        #navBar{
            width: auto;
            height: auto;
            position: fixed;
            right:0;
            bottom: 0;
            background-color: #f0f3f4;
            overflow-y: auto;
            text-align: center;
        }
        #svg-container{
            width: 100%;
            overflow-x: scroll;
            min-width: 0px;
            margin: 0 10px;
            overflow: visible;
            position: relative;
        }
        #nav-thumbs{
            overflow-y: scroll;
            padding: 0 5px;
        }
        .nav-thumb{
            position: relative;
            margin: 10px auto;
        }
        .nav-thumb &gt;p{
            text-align: center;
            font-size: 12px;
            margin: 4px 0 0 0;
        }
        .nav-thumb &gt;div{
            position: relative;
            display: inline-block;
            border: 1px solid #c6cfd5;
        }
        .nav-thumb img{
            display: block;
        }
        #main-content{
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #ffffff;
            display: flex;
            height: auto;
            flex-flow: row wrap;
            text-align:center;
        }
        #svg-container &gt;svg{
            overflow: visible;
            display: block;
            margin:5px auto;
            margin-bottom: 5px;
        }
        #copyright{
            bottom: 0;
            left: 50%;
            margin: 5px auto;
            font-size: 16px;
            color: #515151;
        }
        #copyright &gt;a{
            text-decoration: none;
            color: #77C;
        }
        .number{
            position: absolute;
            top:0;
            left:0;
            border-top:22px solid #08a1ef;
            border-right: 22px solid transparent;
        }
        .pagenum{
            font-size: 12px;
            color: #fff;
            position: absolute;
            top: -23px;
            left: 2px;
        }
            #navBar::-webkit-scrollbar{
            width: 8px;
            background-color: #f5f5f5;
        }
            #navBar::-webkit-scrollbar-track{
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,.3);
            border-radius: 8px;
            background-color: #fff;
        }
            #navBar::-webkit-scrollbar-thumb{
            border-radius: 8px;
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,.3);
            background-color: #6b6b70;
        }
        #navBar::-webkit-scrollbar-thumb:hover{
            background-color: #4a4a4f;
        }
</style></head> <body><div id="main-area"><div id="main-content"><div id="svg-container"><svg preserveAspectRadio="xMinYMin meet" xmlns:xlink="http://www.w3.org/1999/xlink" ed:name="iOS锁" ed:vSpacing="30" viewBox="0 0 810 3746" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns="http://www.w3.org/2000/svg" height="3814" xmlns:ed="https://www.edrawsoft.cn/xml/2017/SVGExtensions/" ed:hSpacing="30" width="810" id="page11"><style type="text/css">&lt;![CDATA[
g[ed\:togtopicid],g[ed\:hyperlink],g[ed\:comment],g[ed\:note] {cursor:pointer;}
g[id] {-moz-user-select: none;-ms-user-select: none;user-select: none;}
svg text::selection,svg tspan::selection{background-color: #4285f4;color: #ffffff;fill: #ffffff;}
.st23 {fill:#141414;font-family:微软雅黑;font-size:10.5pt}
.st21 {fill:#4caf50;font-family:微软雅黑;font-size:12pt;font-weight:bold}
.st22 {fill:#ffffff;font-family:微软雅黑;font-size:13.5pt}
]]&gt;</style> <defs></defs> <rect x="0" y="0" fill="#ffffff" height="3814" width="810"></rect> <path d="M8,0L261.1,0C266.5,0,269.1,2.6,269.1,8L269.1,269C269.1,274.4,266.5,277,261.1,277L8,277C2.6,277,0,274.4,0,269L0,8C0,2.6,2.6,0,8,0z" stroke="#4caf50" stroke-dasharray="5,2" ed:idlist="139" stroke-width="2" transform="matrix(1,0,0,1,209.2,795)" ed:type="boundary" ed:parentid="139" stroke-linejoin="round" fill-opacity="0.2" fill="#4caf50" id="138"></path> <path d="M8,0L416.1,0C421.5,0,424.1,2.6,424.1,8L424.1,282C424.1,287.4,421.5,290,416.1,290L8,290C2.6,290,0,287.4,0,282L0,8C0,2.6,2.6,0,8,0z" stroke="#4caf50" stroke-dasharray="5,2" ed:idlist="185" stroke-width="2" transform="matrix(1,0,0,1,209.2,2047.5)" ed:type="boundary" ed:parentid="185" stroke-linejoin="round" fill-opacity="0.2" fill="#4caf50" id="184"></path> <path d="M8,0L326.7,0C332.1,0,334.7,2.6,334.7,8L334.7,61C334.7,66.4,332.1,69,326.7,69L8,69C2.6,69,0,66.4,0,61L0,8C0,2.6,2.6,0,8,0z" stroke="#4caf50" stroke-dasharray="5,2" ed:idlist="210" stroke-width="2" transform="matrix(1,0,0,1,209.2,2790.5)" ed:type="boundary" ed:parentid="210" stroke-linejoin="round" fill-opacity="0.2" fill="#4caf50" id="209"></path> <path d="M8,0L411.3,0C416.7,0,419.3,2.6,419.3,8L419.3,180C419.3,185.4,416.7,188,411.3,188L8,188C2.6,188,0,185.4,0,180L0,8C0,2.6,2.6,0,8,0z" stroke="#4caf50" stroke-dasharray="5,2" ed:idlist="156" stroke-width="2" transform="matrix(1,0,0,1,252.6,1355)" ed:type="boundary" ed:parentid="156" stroke-linejoin="round" fill-opacity="0.2" fill="#4caf50" id="155"></path> <path stroke="#4caf50" d="M-25.2,-26.5L-25.2,20.5C-25.2,23.8,-22.5,26.5,-19.2,26.5L25.2,26.5" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,83.2,158.5)" ed:parentid="112" stroke-linejoin="round" fill="none" ed:tosuperid="113" id="114"></path> <path stroke="#4caf50" d="M-25.2,-69.5L-25.2,63.5C-25.2,66.8,-22.5,69.5,-19.2,69.5L25.2,69.5" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,83.2,201.5)" ed:parentid="112" stroke-linejoin="round" fill="none" ed:tosuperid="115" id="116"></path> <path stroke="#4caf50" d="M-25.2,-119L-25.2,113C-25.2,116.3,-22.5,119,-19.2,119L25.2,119" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,83.2,251)" ed:parentid="112" stroke-linejoin="round" fill="none" ed:tosuperid="117" id="118"></path> <path stroke="#4caf50" d="M-25.2,-162L-25.2,156C-25.2,159.3,-22.5,162,-19.2,162L25.2,162" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,83.2,294)" ed:parentid="112" stroke-linejoin="round" fill="none" ed:tosuperid="119" id="120"></path> <path stroke="#4caf50" d="M-9.5,-11.1L-9.5,5.1C-9.5,8.4,-6.8,11.1,-3.5,11.1L9.5,11.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,487.13)" ed:parentid="119" stroke-linejoin="round" fill="none" ed:tosuperid="121" id="122"></path> <path stroke="#4caf50" d="M-25.2,-215.9L-25.2,209.9C-25.2,213.2,-22.5,215.9,-19.2,215.9L25.2,215.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,83.2,347.88)" ed:parentid="112" stroke-linejoin="round" fill="none" ed:tosuperid="123" id="124"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,594.63)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="126" id="127"></path> <path stroke="#4caf50" d="M-9.5,-28L-9.5,22C-9.5,25.3,-6.8,28,-3.5,28L9.5,28" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,611.75)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="128" id="129"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,203.75,663.13)" ed:parentid="128" stroke-linejoin="round" fill="none" ed:tosuperid="130" id="131"></path> <path stroke="#4caf50" d="M-9.5,-62.3L-9.5,56.3C-9.5,59.6,-6.8,62.3,-3.5,62.3L9.5,62.3" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,646)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="132" id="133"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,731.63)" ed:parentid="132" stroke-linejoin="round" fill="none" ed:tosuperid="134" id="135"></path> <path stroke="#4caf50" d="M-9.5,-95.5L-9.5,89.5C-9.5,92.8,-6.8,95.5,-3.5,95.5L9.5,95.5" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,679.25)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="136" id="137"></path> <path stroke="#4caf50" d="M-9.5,-74.1L-9.5,68.1C-9.5,71.4,-6.8,74.1,-3.5,74.1L9.5,74.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,859.38)" ed:parentid="136" stroke-linejoin="round" fill="none" ed:tosuperid="139" id="140"></path> <path stroke="#4caf50" d="M-9.5,-154.3L-9.5,148.3C-9.5,151.6,-6.8,154.3,-3.5,154.3L9.5,154.3" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,939.5)" ed:parentid="136" stroke-linejoin="round" fill="none" ed:tosuperid="141" id="142"></path> <path stroke="#4caf50" d="M-9.5,-271.1L-9.5,265.1C-9.5,268.4,-6.8,271.1,-3.5,271.1L9.5,271.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,854.88)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="143" id="144"></path> <path stroke="#4caf50" d="M-9.5,-15.9L-9.5,9.9C-9.5,13.2,-6.8,15.9,-3.5,15.9L9.5,15.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1152.38)" ed:parentid="143" stroke-linejoin="round" fill="none" ed:tosuperid="145" id="146"></path> <path stroke="#4caf50" d="M-9.5,-37.8L-9.5,31.8C-9.5,35.1,-6.8,37.8,-3.5,37.8L9.5,37.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1174.25)" ed:parentid="143" stroke-linejoin="round" fill="none" ed:tosuperid="147" id="148"></path> <path stroke="#4caf50" d="M-9.5,-59.6L-9.5,53.6C-9.5,56.9,-6.8,59.6,-3.5,59.6L9.5,59.6" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1196.13)" ed:parentid="143" stroke-linejoin="round" fill="none" ed:tosuperid="149" id="150"></path> <path stroke="#4caf50" d="M-9.5,-81.5L-9.5,75.5C-9.5,78.8,-6.8,81.5,-3.5,81.5L9.5,81.5" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1218)" ed:parentid="143" stroke-linejoin="round" fill="none" ed:tosuperid="151" id="152"></path> <path stroke="#4caf50" d="M-9.5,-98.4L-9.5,92.4C-9.5,95.7,-6.8,98.4,-3.5,98.4L9.5,98.4" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1234.88)" ed:parentid="143" stroke-linejoin="round" fill="none" ed:tosuperid="153" id="154"></path> <path stroke="#4caf50" d="M-9.5,-51.9L-9.5,45.9C-9.5,49.2,-6.8,51.9,-3.5,51.9L9.5,51.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,1397.13)" ed:parentid="153" stroke-linejoin="round" fill="none" ed:tosuperid="156" id="157"></path> <path stroke="#4caf50" d="M-9.5,-109.8L-9.5,103.8C-9.5,107.1,-6.8,109.8,-3.5,109.8L9.5,109.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,1455)" ed:parentid="153" stroke-linejoin="round" fill="none" ed:tosuperid="158" id="159"></path> <path stroke="#4caf50" d="M-9.5,-126.6L-9.5,120.6C-9.5,123.9,-6.8,126.6,-3.5,126.6L9.5,126.6" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,1471.88)" ed:parentid="153" stroke-linejoin="round" fill="none" ed:tosuperid="160" id="161"></path> <path stroke="#4caf50" d="M-9.5,-148.5L-9.5,142.5C-9.5,145.8,-6.8,148.5,-3.5,148.5L9.5,148.5" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,1493.75)" ed:parentid="153" stroke-linejoin="round" fill="none" ed:tosuperid="162" id="163"></path> <path stroke="#4caf50" d="M-9.5,-279.8L-9.5,273.8C-9.5,277.1,-6.8,279.8,-3.5,279.8L9.5,279.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1416.25)" ed:parentid="143" stroke-linejoin="round" fill="none" ed:tosuperid="164" id="165"></path> <path stroke="#4caf50" d="M-9.5,-16.1L-9.5,10.1C-9.5,13.4,-6.8,16.1,-3.5,16.1L9.5,16.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,260.65,1734.13)" ed:parentid="164" stroke-linejoin="round" fill="none" ed:tosuperid="166" id="167"></path> <path stroke="#4caf50" d="M-9.5,-38.5L-9.5,32.5C-9.5,35.8,-6.8,38.5,-3.5,38.5L9.5,38.5" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,260.65,1756.5)" ed:parentid="164" stroke-linejoin="round" fill="none" ed:tosuperid="168" id="169"></path> <path stroke="#4caf50" d="M-9.5,-622L-9.5,616C-9.5,619.3,-6.8,622,-3.5,622L9.5,622" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,1205.75)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="170" id="171"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1849.13)" ed:parentid="170" stroke-linejoin="round" fill="none" ed:tosuperid="172" id="173"></path> <path stroke="#4caf50" d="M-9.5,-27.8L-9.5,21.8C-9.5,25.1,-6.8,27.8,-3.5,27.8L9.5,27.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1866)" ed:parentid="170" stroke-linejoin="round" fill="none" ed:tosuperid="174" id="175"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,260.65,1916.63)" ed:parentid="174" stroke-linejoin="round" fill="none" ed:tosuperid="176" id="177"></path> <path stroke="#4caf50" d="M-9.5,-27.8L-9.5,21.8C-9.5,25.1,-6.8,27.8,-3.5,27.8L9.5,27.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,260.65,1933.5)" ed:parentid="174" stroke-linejoin="round" fill="none" ed:tosuperid="178" id="179"></path> <path stroke="#4caf50" d="M-9.5,-78.4L-9.5,72.4C-9.5,75.7,-6.8,78.4,-3.5,78.4L9.5,78.4" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,1916.63)" ed:parentid="170" stroke-linejoin="round" fill="none" ed:tosuperid="180" id="181"></path> <path stroke="#4caf50" d="M-9.5,-721.8L-9.5,715.8C-9.5,719.1,-6.8,721.8,-3.5,721.8L9.5,721.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,1305.5)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="182" id="183"></path> <path stroke="#4caf50" d="M-9.5,-77.4L-9.5,71.4C-9.5,74.7,-6.8,77.4,-3.5,77.4L9.5,77.4" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2115.13)" ed:parentid="182" stroke-linejoin="round" fill="none" ed:tosuperid="185" id="186"></path> <path stroke="#4caf50" d="M-9.5,-160.8L-9.5,154.8C-9.5,158.1,-6.8,160.8,-3.5,160.8L9.5,160.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2198.5)" ed:parentid="182" stroke-linejoin="round" fill="none" ed:tosuperid="187" id="188"></path> <path stroke="#4caf50" d="M-9.5,-177.6L-9.5,171.6C-9.5,174.9,-6.8,177.6,-3.5,177.6L9.5,177.6" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2215.38)" ed:parentid="182" stroke-linejoin="round" fill="none" ed:tosuperid="189" id="190"></path> <path stroke="#4caf50" d="M-9.5,-15.9L-9.5,9.9C-9.5,13.2,-6.8,15.9,-3.5,15.9L9.5,15.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,2420.88)" ed:parentid="189" stroke-linejoin="round" fill="none" ed:tosuperid="191" id="192"></path> <path stroke="#4caf50" d="M-9.5,-48L-9.5,42C-9.5,45.3,-6.8,48,-3.5,48L9.5,48" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,2453)" ed:parentid="189" stroke-linejoin="round" fill="none" ed:tosuperid="193" id="194"></path> <path stroke="#4caf50" d="M-9.5,-985L-9.5,979C-9.5,982.3,-6.8,985,-3.5,985L9.5,985" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,1568.75)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="195" id="196"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2575.13)" ed:parentid="195" stroke-linejoin="round" fill="none" ed:tosuperid="197" id="198"></path> <path stroke="#4caf50" d="M-9.5,-27.8L-9.5,21.8C-9.5,25.1,-6.8,27.8,-3.5,27.8L9.5,27.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2592)" ed:parentid="195" stroke-linejoin="round" fill="none" ed:tosuperid="199" id="200"></path> <path stroke="#4caf50" d="M-9.5,-1034.1L-9.5,1028.1C-9.5,1031.4,-6.8,1034.1,-3.5,1034.1L9.5,1034.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,1617.88)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="201" id="202"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2673.38)" ed:parentid="201" stroke-linejoin="round" fill="none" ed:tosuperid="203" id="204"></path> <path stroke="#4caf50" d="M-9.5,-32.8L-9.5,26.8C-9.5,30.1,-6.8,32.8,-3.5,32.8L9.5,32.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2695.25)" ed:parentid="201" stroke-linejoin="round" fill="none" ed:tosuperid="205" id="206"></path> <path stroke="#4caf50" d="M-9.5,-1093.3L-9.5,1087.3C-9.5,1090.6,-6.8,1093.3,-3.5,1093.3L9.5,1093.3" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,1677)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="207" id="208"></path> <path stroke="#4caf50" d="M-9.5,-22.1L-9.5,16.1C-9.5,19.4,-6.8,22.1,-3.5,22.1L9.5,22.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2802.88)" ed:parentid="207" stroke-linejoin="round" fill="none" ed:tosuperid="210" id="211"></path> <path stroke="#4caf50" d="M-9.5,-50.3L-9.5,44.3C-9.5,47.6,-6.8,50.3,-3.5,50.3L9.5,50.3" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2831)" ed:parentid="207" stroke-linejoin="round" fill="none" ed:tosuperid="212" id="213"></path> <path stroke="#4caf50" d="M-9.5,-67.1L-9.5,61.1C-9.5,64.4,-6.8,67.1,-3.5,67.1L9.5,67.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2847.88)" ed:parentid="207" stroke-linejoin="round" fill="none" ed:tosuperid="214" id="215"></path> <path stroke="#4caf50" d="M-9.5,-1181.8L-9.5,1175.8C-9.5,1179.1,-6.8,1181.8,-3.5,1181.8L9.5,1181.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,1765.5)" ed:parentid="123" stroke-linejoin="round" fill="none" ed:tosuperid="216" id="217"></path> <path stroke="#4caf50" d="M-9.5,-15.9L-9.5,9.9C-9.5,13.2,-6.8,15.9,-3.5,15.9L9.5,15.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,2973.63)" ed:parentid="216" stroke-linejoin="round" fill="none" ed:tosuperid="218" id="219"></path> <path stroke="#4caf50" d="M-25.2,-1466.3L-25.2,1460.3C-25.2,1463.6,-22.5,1466.3,-19.2,1466.3L25.2,1466.3" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,83.2,1598.25)" ed:parentid="112" stroke-linejoin="round" fill="none" ed:tosuperid="220" id="221"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,3095.38)" ed:parentid="220" stroke-linejoin="round" fill="none" ed:tosuperid="223" id="224"></path> <path stroke="#4caf50" d="M-9.5,-27.8L-9.5,21.8C-9.5,25.1,-6.8,27.8,-3.5,27.8L9.5,27.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,3112.25)" ed:parentid="220" stroke-linejoin="round" fill="none" ed:tosuperid="225" id="226"></path> <path stroke="#4caf50" d="M-9.5,-44.6L-9.5,38.6C-9.5,41.9,-6.8,44.6,-3.5,44.6L9.5,44.6" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,3129.13)" ed:parentid="220" stroke-linejoin="round" fill="none" ed:tosuperid="227" id="228"></path> <path stroke="#4caf50" d="M-9.5,-60.8L-9.5,54.8C-9.5,58.1,-6.8,60.8,-3.5,60.8L9.5,60.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,3145.25)" ed:parentid="220" stroke-linejoin="round" fill="none" ed:tosuperid="229" id="230"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3227.38)" ed:parentid="229" stroke-linejoin="round" fill="none" ed:tosuperid="231" id="232"></path> <path stroke="#4caf50" d="M-9.5,-32.8L-9.5,26.8C-9.5,30.1,-6.8,32.8,-3.5,32.8L9.5,32.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3249.25)" ed:parentid="229" stroke-linejoin="round" fill="none" ed:tosuperid="233" id="234"></path> <path stroke="#4caf50" d="M-9.5,-119.9L-9.5,113.9C-9.5,117.2,-6.8,119.9,-3.5,119.9L9.5,119.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,3204.38)" ed:parentid="220" stroke-linejoin="round" fill="none" ed:tosuperid="235" id="236"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3345.63)" ed:parentid="235" stroke-linejoin="round" fill="none" ed:tosuperid="237" id="238"></path> <path stroke="#4caf50" d="M-9.5,-27.8L-9.5,21.8C-9.5,25.1,-6.8,27.8,-3.5,27.8L9.5,27.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3362.5)" ed:parentid="235" stroke-linejoin="round" fill="none" ed:tosuperid="239" id="240"></path> <path stroke="#4caf50" d="M-9.5,-44.9L-9.5,38.9C-9.5,42.2,-6.8,44.9,-3.5,44.9L9.5,44.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3379.63)" ed:parentid="235" stroke-linejoin="round" fill="none" ed:tosuperid="241" id="242"></path> <path stroke="#4caf50" d="M-9.5,-187.1L-9.5,181.1C-9.5,184.4,-6.8,187.1,-3.5,187.1L9.5,187.1" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,152.85,3271.63)" ed:parentid="220" stroke-linejoin="round" fill="none" ed:tosuperid="243" id="244"></path> <path stroke="#4caf50" d="M-9.5,-10.9L-9.5,4.9C-9.5,8.2,-6.8,10.9,-3.5,10.9L9.5,10.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3481.63)" ed:parentid="243" stroke-linejoin="round" fill="none" ed:tosuperid="245" id="246"></path> <path stroke="#4caf50" d="M-9.5,-27.8L-9.5,21.8C-9.5,25.1,-6.8,27.8,-3.5,27.8L9.5,27.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3498.5)" ed:parentid="243" stroke-linejoin="round" fill="none" ed:tosuperid="247" id="248"></path> <path stroke="#4caf50" d="M-9.5,-44.6L-9.5,38.6C-9.5,41.9,-6.8,44.6,-3.5,44.6L9.5,44.6" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3515.38)" ed:parentid="243" stroke-linejoin="round" fill="none" ed:tosuperid="249" id="250"></path> <path stroke="#4caf50" d="M-9.5,-15.9L-9.5,9.9C-9.5,13.2,-6.8,15.9,-3.5,15.9L9.5,15.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,3587.88)" ed:parentid="249" stroke-linejoin="round" fill="none" ed:tosuperid="251" id="252"></path> <path stroke="#4caf50" d="M-9.5,-88.4L-9.5,82.4C-9.5,85.7,-6.8,88.4,-3.5,88.4L9.5,88.4" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3559.13)" ed:parentid="243" stroke-linejoin="round" fill="none" ed:tosuperid="253" id="254"></path> <path stroke="#4caf50" d="M-9.5,-15.9L-9.5,9.9C-9.5,13.2,-6.8,15.9,-3.5,15.9L9.5,15.9" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,3675.38)" ed:parentid="253" stroke-linejoin="round" fill="none" ed:tosuperid="255" id="256"></path> <path stroke="#4caf50" d="M-9.5,-37.8L-9.5,31.8C-9.5,35.1,-6.8,37.8,-3.5,37.8L9.5,37.8" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,250.15,3697.25)" ed:parentid="253" stroke-linejoin="round" fill="none" ed:tosuperid="257" id="258"></path> <path stroke="#4caf50" d="M-9.5,-149L-9.5,143C-9.5,146.3,-6.8,149,-3.5,149L9.5,149" stroke-linecap="round" stroke-width="3" transform="matrix(1,0,0,1,206.75,3619.75)" ed:parentid="243" stroke-linejoin="round" fill="none" ed:tosuperid="259" id="260"></path> <g ed:height="53" ed:layout="righttree" transform="matrix(1,0,0,1,23,79)" id="112" ed:topictype="mainidea" ed:width="87.515625"><path stroke="#4caf50" d="M4,0L83.5,0C86.2,0,87.5,1.3,87.5,4L87.5,49C87.5,51.7,86.2,53,83.5,53L4,53C1.3,53,0,51.7,0,49L0,4C0,1.3,1.3,0,4,0z" stroke-width="3" stroke-linejoin="round" fill="none"></path> <text class="st21"><tspan x="22" y="30" textLength="44">iOS锁</tspan></text></g> <g ed:height="40" transform="matrix(1,0,0,1,108.4,165)" ed:parentid="112" id="113" ed:width="434"><path d="M4,0L430,0C432.7,0,434,1.3,434,4L434,36C434,38.7,432.7,40,430,40L4,40C1.3,40,0,38.7,0,36L0,4C0,1.3,1.3,0,4,0z" fill="#4caf50"></path> <text class="st22"><tspan x="19" y="24" textLength="396">多线程下写操作可能导致的问题，锁住资源，等待</tspan></text></g> <g ed:height="66" transform="matrix(1,0,0,1,108.4,238)" ed:parentid="112" id="115" ed:width="282.859375"><path d="M4,0L278.9,0C281.5,0,282.9,1.3,282.9,4L282.9,62C282.9,64.7,281.5,66,278.9,66L4,66C1.3,66,0,64.7,0,62L0,4C0,1.3,1.3,0,4,0z" fill="#4caf50"></path> <text class="st22"><tspan x="19" y="24" textLength="245">在iOS中锁的基本种类只有两种</tspan> <tspan x="19" y="50" textLength="188">：`互斥锁`、`自旋锁`</tspan></text></g> <g ed:height="66" transform="matrix(1,0,0,1,108.4,337)" ed:parentid="112" id="117" ed:width="534"><path d="M4,0L530,0C532.7,0,534,1.3,534,4L534,62C534,64.7,532.7,66,530,66L4,66C1.3,66,0,64.7,0,62L0,4C0,1.3,1.3,0,4,0z" fill="#4caf50"></path> <text class="st22"><tspan x="19" y="24" textLength="497">变相的，你可以通过 串行队列，栅栏函数 等实现类似加锁能力</tspan></text></g> <g ed:height="40" transform="matrix(1,0,0,1,108.4,436)" ed:parentid="112" id="119" ed:width="164"><path d="M4,0L160,0C162.7,0,164,1.3,164,4L164,36C164,38.7,162.7,40,160,40L4,40C1.3,40,0,38.7,0,36L0,4C0,1.3,1.3,0,4,0z" fill="#4caf50"></path> <text class="st22"><tspan x="19" y="24" textLength="126">加锁性能排行：</tspan></text></g> <g ed:height="25" transform="matrix(1,0,0,1,162.3,485.75)" ed:parentid="119" id="121" ed:width="496.125"><path d="M4,0L492.1,0C494.8,0,496.1,1.3,496.1,4L496.1,21C496.1,23.7,494.8,25,492.1,25L4,25C1.3,25,0,23.7,0,21L0,4C0,1.3,1.3,0,4,0z" stroke="#4caf50" stroke-width="2" stroke-linejoin="round" fill="#ff9595"></path> <text class="st23"><tspan x="10" y="16.5" textLength="474">信号量 &gt;  互斥锁pthread_mutex &gt;  NSLock &gt; 条件锁 &gt;  @synchronized</tspan></text></g> <g ed:height="40" transform="matrix(1,0,0,1,108.4,543.75)" ed:parentid="112" id="123" ed:width="115"><path d="M4,0L111,0C113.7,0,115,1.3,115,4L115,36C115,38.7,113.7,40,111,40L4,40C1.3,40,0,38.7,0,36L0,4C0,1.3,1.3,0,4,0z" fill="#ff9f00"></path> <g transform="translate(18,10.1)"><use transform="translate(0,0)" xlink:href="#imgpriority1"></use></g> <text class="st22"><tspan x="43" y="24" textLength="54">互斥锁</tspan></text></g> <symbol id="imgpriority1"><image xlink:href="data:image/png;base64,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" height="16" width="16"></image></symbol> <g ed:height="24" transform="matrix(1,0,0,1,162.3,593.5)" ed:parentid="123" id="126" ed:width="441"><text class="st23"><tspan x="10" y="16" textLength="420">发现资源被其它线程锁住后，线程会进入睡眠，等待锁释放时被唤醒</tspan></text></g> <g ed:height="25" transform="matrix(1,0,0,1,162.3,627.25)" ed:parentid="123" id="128" ed:width="64"><path stroke="#ff6f00" d="M4,0L60,0C62.7,0,64,1.3,64,4L64,21C64,23.7,62.7,25,60,25L4,25C1.3,25,0,23.7,0,21L0,4C0,1.3,1.3,0,4,0z" stroke-width="2" stroke-linejoin="round" fill="none"></path> <text class="st23"><tspan x="10" y="16.5" textLength="42">递归锁</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,213.2,662)" ed:parentid="128" id="130" ed:width="427"><text class="st23"><tspan x="10" y="16" textLength="406">可重入锁，同一个线程在锁释放前可再次获取锁，即可以递归调用</tspan></text></g> <g ed:height="25" transform="matrix(1,0,0,1,162.3,695.75)" ed:parentid="123" id="132" ed:width="78"><path stroke="#ff9f00" d="M4,0L74,0C76.7,0,78,1.3,78,4L78,21C78,23.7,76.7,25,74,25L4,25C1.3,25,0,23.7,0,21L0,4C0,1.3,1.3,0,4,0z" stroke-width="2" stroke-linejoin="round" fill="none"></path> <text class="st23"><tspan x="10" y="16.5" textLength="56">非递归锁</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,730.5)" ed:parentid="132" id="134" ed:width="287"><text class="st23"><tspan x="10" y="16" textLength="266">不可重入，必须等锁释放后才能再次获取锁</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,764.25)" ed:parentid="123" id="136" ed:width="137.375"><text class="st23"><tspan x="10" y="16" textLength="116">1.pthread_mutex</tspan></text></g> <g ed:height="263" transform="matrix(1,0,0,1,216.2,802)" ed:parentid="136" id="139" ed:width="255.125"><text class="st23"><tspan x="10" y="16" textLength="89">// 导入头文件</tspan> <tspan x="10" y="36" textLength="147">#import &lt;pthread.h&gt;</tspan> <tspan x="10" y="53" textLength="117">// 全局声明互斥锁</tspan> <tspan x="10" y="73" textLength="159">pthread_mutex_t _lock;</tspan> <tspan x="10" y="90" textLength="103">// 初始化互斥锁</tspan> <tspan x="10" y="110" textLength="234">pthread_mutex_init(&amp;_lock, NULL);</tspan> <tspan x="10" y="127" textLength="47">// 加锁</tspan> <tspan x="10" y="147" textLength="196">pthread_mutex_lock(&amp;_lock);</tspan> <tspan x="10" y="164" textLength="173">// 这里做需要线程安全操作</tspan> <tspan x="10" y="184" textLength="32">// ...</tspan> <tspan x="10" y="201" textLength="52">// 解锁 </tspan> <tspan x="10" y="221" textLength="214">pthread_mutex_unlock(&amp;_lock);</tspan> <tspan x="10" y="238" textLength="61">// 释放锁</tspan> <tspan x="10" y="258" textLength="219">pthread_mutex_destroy(&amp;_lock);</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,1081.75)" ed:parentid="136" id="141" ed:width="389.1875"><text class="st23"><tspan x="10" y="16" textLength="368">YYKit的YYMemoryCach， 使用到`pthread_mutex` 封装</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,1115.5)" ed:parentid="123" id="143" ed:width="136.90625"><text class="st23"><tspan x="10" y="16" textLength="116">2.@synchronized</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,216.2,1146.25)" ed:parentid="143" id="145" ed:width="517"><text class="st23"><tspan x="10" y="16" textLength="459">通过**汇编**能发现`@synchronized`就是实现了`objc_sync_enter`和 </tspan> <tspan x="10" y="36" textLength="172">`objc_sync_exit`两个方法</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,1200)" ed:parentid="143" id="147" ed:width="175"><text class="st23"><tspan x="10" y="16" textLength="154">性能较差，使用比较方便</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,216.2,1233.75)" ed:parentid="143" id="149" ed:width="517"><text class="st23"><tspan x="10" y="16" textLength="494">是递归锁， 可以在释放锁之前，继续获取锁权限，但是最好不要嵌套太深，影响</tspan> <tspan x="10" y="36" textLength="28">性能</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,1287.5)" ed:parentid="143" id="151" ed:width="489.921875"><text class="st23"><tspan x="10" y="16" textLength="469">不能使用`非OC对象`作为加锁条件——底层`id2data`中接收参数为id类型</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,1321.25)" ed:parentid="143" id="153" ed:width="49"><text class="st23"><tspan x="10" y="16" textLength="28">案例</tspan></text></g> <g ed:height="174" transform="matrix(1,0,0,1,259.6,1362)" ed:parentid="153" id="156" ed:width="405.34375"><text class="st23"><tspan x="10" y="16" textLength="85">- (void)test {</tspan> <tspan x="10" y="33" textLength="267">    _testArray = [NSMutableArray array];</tspan> <tspan x="10" y="50" textLength="236">    for (int i = 0; i &lt; 200000; i++) {</tspan> <tspan x="10" y="67" textLength="384">        dispatch_async(dispatch_get_global_queue(0, 0), ^{</tspan> <tspan x="10" y="84" textLength="268">            @synchronized (self.testArray) {</tspan> <tspan x="10" y="101" textLength="341">                self.testArray = [NSMutableArray array];</tspan> <tspan x="10" y="118" textLength="58">            }</tspan> <tspan x="10" y="135" textLength="49">        });</tspan> <tspan x="10" y="152" textLength="22">    }</tspan> <tspan x="10" y="169" textLength="5">}</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,259.6,1552.75)" ed:parentid="153" id="158" ed:width="390.890625"><text class="st23"><tspan x="10" y="16" textLength="370">上述代码会crash，因为在某一瞬间`testArray`释放了为nil</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,259.6,1586.5)" ed:parentid="153" id="160" ed:width="377.21875"><text class="st23"><tspan x="10" y="16" textLength="356">可以对self加锁，但是又太重了，锁self也存在异常到时候</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,259.6,1620.25)" ed:parentid="153" id="162" ed:width="517"><text class="st23"><tspan x="10" y="16" textLength="486">可以创建一个静态变量 static ，一个synchronized使用一个对这个静态变量加</tspan> <tspan x="10" y="36" textLength="210">锁，其它线程也能访问到这个变量</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,216.2,1674)" ed:parentid="143" id="164" ed:width="517"><path d="M4,0L513,0C515.7,0,517,1.3,517,4L517,40C517,42.7,515.7,44,513,44L4,44C1.3,44,0,42.7,0,40L0,4C0,1.3,1.3,0,4,0z" fill="#fdd834"></path> <text class="st23"><tspan x="10" y="16" textLength="496">加锁原理类似 weak 哈希表，把对象映射到一张hash表上，记录被锁的次数，这</tspan> <tspan x="10" y="36" textLength="126">样可以适用递归场景</tspan></text></g> <g ed:height="45" transform="matrix(1,0,0,1,270.1,1727.75)" ed:parentid="164" id="166" ed:width="518"><path stroke="#4caf50" d="M4,0L514,0C516.7,0,518,1.3,518,4L518,41C518,43.7,516.7,45,514,45L4,45C1.3,45,0,43.7,0,41L0,4C0,1.3,1.3,0,4,0z" stroke-width="2" stroke-linejoin="round" fill="none"></path> <text class="st23"><tspan x="10" y="16.5" textLength="493">空对象在准备加锁前会判断，这样保证不会对nil加锁，但是加锁以后对象被释放</tspan> <tspan x="10" y="36.5" textLength="56">是不行的</tspan></text></g> <g ed:height="25" transform="matrix(1,0,0,1,270.1,1782.5)" ed:parentid="164" id="168" ed:width="246"><path stroke="#4caf50" d="M4,0L242,0C244.7,0,246,1.3,246,4L246,21C246,23.7,244.7,25,242,25L4,25C1.3,25,0,23.7,0,21L0,4C0,1.3,1.3,0,4,0z" stroke-width="2" stroke-linejoin="round" fill="none"></path> <text class="st23"><tspan x="10" y="16.5" textLength="224">缓存（表映射）取对象不会导致死锁</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,1817.25)" ed:parentid="123" id="170" ed:width="83.5"><text class="st23"><tspan x="10" y="16" textLength="63">3.NSLock</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,1848)" ed:parentid="170" id="172" ed:width="282.53125"><text class="st23"><tspan x="10" y="16" textLength="262">本质就是对pthread_mutex 互斥锁的封装</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,1881.75)" ed:parentid="170" id="174" ed:width="273"><text class="st23"><tspan x="10" y="16" textLength="252">非递归锁，不适应递归场景，会堵塞线程</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,270.1,1915.5)" ed:parentid="174" id="176" ed:width="482.953125"><text class="st23"><tspan x="10" y="16" textLength="462">使用互斥锁`NSLock`异步并发调用block块，block块内部递归调用自己，</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,270.1,1949.25)" ed:parentid="174" id="178" ed:width="133"><text class="st23"><tspan x="10" y="16" textLength="112">那么就会线程堵塞</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,1983)" ed:parentid="170" id="180" ed:width="417.609375"><text class="st23"><tspan x="10" y="16" textLength="397">**解决方案：** 使用递归锁`NSRecursiveLock`替换`NSLock`</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,2016.75)" ed:parentid="123" id="182" ed:width="147.90625"><text class="st23"><tspan x="10" y="16" textLength="127">4.NSRecursiveLock</tspan></text></g> <g ed:height="276" transform="matrix(1,0,0,1,216.2,2054.5)" ed:parentid="182" id="185" ed:width="410.09375"><text class="st23"><tspan x="10" y="16" textLength="85">- (void)test {</tspan> <tspan x="10" y="33" textLength="389">    NSRecursiveLock *lock = [[NSRecursiveLock alloc] init];</tspan> <tspan x="10" y="50" textLength="367">    dispatch_async(dispatch_get_global_queue(0, 0), ^{</tspan> <tspan x="10" y="67" textLength="196">        static void (^block)(int);</tspan> <tspan x="10" y="84" textLength="35"></tspan> <tspan x="10" y="101" textLength="177">        block = ^(int value) {</tspan> <tspan x="10" y="118" textLength="127">            [lock lock];</tspan> <tspan x="10" y="135" textLength="149">            if (value &gt; 0) {</tspan> <tspan x="10" y="152" textLength="275">                NSLog(@&quot;value——%d&quot;, value);</tspan> <tspan x="10" y="169" textLength="182">                block(value - 1);</tspan> <tspan x="10" y="186" textLength="58">            }</tspan> <tspan x="10" y="203" textLength="144">            [lock unlock];</tspan> <tspan x="10" y="220" textLength="44">        };</tspan> <tspan x="10" y="237" textLength="103">        block(10);</tspan> <tspan x="10" y="254" textLength="31">    });</tspan> <tspan x="10" y="271" textLength="5">}</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,2347.25)" ed:parentid="182" id="187" ed:width="444.453125"><text class="st23"><tspan x="10" y="16" textLength="423">NSRecursiveLock`在[YYKit中YYWebImageOperation.m]中有用到</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,2381)" ed:parentid="182" id="189" ed:width="49"><text class="st23"><tspan x="10" y="16" textLength="28">死锁</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,259.6,2414.75)" ed:parentid="189" id="191" ed:width="517"><text class="st23"><tspan x="10" y="16" textLength="487">for循环在block内部对同一个对象进行了多次锁操作，直到这个资源身上挂着N</tspan> <tspan x="10" y="36" textLength="350">把锁，最后大家都无法一次性解锁——找不到解锁的出口</tspan></text></g> <g ed:height="65" transform="matrix(1,0,0,1,259.6,2468.5)" ed:parentid="189" id="193" ed:width="518"><path stroke="#4caf50" d="M4,0L514,0C516.7,0,518,1.3,518,4L518,61C518,63.7,516.7,65,514,65L4,65C1.3,65,0,63.7,0,61L0,4C0,1.3,1.3,0,4,0z" stroke-width="2" stroke-linejoin="round" fill="none"></path> <text class="st23"><tspan x="10" y="16.5" textLength="473">**解决：** 可以采用使用缓存的`@synchronized`，因为它对对象进行锁操</tspan> <tspan x="10" y="36.5" textLength="485">作，会先从缓存查找是否有锁`syncData`存在。如果有，直接返回而不加锁，</tspan> <tspan x="10" y="56.5" textLength="98">保证锁的唯一性</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,2543.25)" ed:parentid="123" id="195" ed:width="174.125"><text class="st23"><tspan x="10" y="16" textLength="153">5.dispatch_semaphore</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,2574)" ed:parentid="195" id="197" ed:width="93.265625"><text class="st23"><tspan x="10" y="16" textLength="72">GCD信号量</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,2607.75)" ed:parentid="195" id="199" ed:width="105"><text class="st23"><tspan x="10" y="16" textLength="84">通过控制数值</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,2641.5)" ed:parentid="123" id="201" ed:width="118.484375"><text class="st23"><tspan x="10" y="16" textLength="97">6.NSCondition</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,2672.25)" ed:parentid="201" id="203" ed:width="105"><text class="st23"><tspan x="10" y="16" textLength="84">是一个条件锁</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,216.2,2706)" ed:parentid="201" id="205" ed:width="517"><text class="st23"><tspan x="10" y="16" textLength="494">与信号量相似：线程1需要等到条件1满足才会往下走，否则就会堵塞等待，直至</tspan> <tspan x="10" y="36" textLength="56">条件满足</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,2759.75)" ed:parentid="123" id="207" ed:width="149.859375"><text class="st23"><tspan x="10" y="16" textLength="129">7.NSConditionLock</tspan></text></g> <g ed:height="55" transform="matrix(1,0,0,1,216.2,2797.5)" ed:parentid="207" id="210" ed:width="320.71875"><text class="st23"><tspan x="10" y="16" textLength="118">open func lock() {</tspan> <tspan x="10" y="33" textLength="300">        let _ = lock(before: Date.distantFuture)</tspan> <tspan x="10" y="50" textLength="22">    }</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,2869.25)" ed:parentid="207" id="212" ed:width="367.1875"><text class="st23"><tspan x="10" y="16" textLength="346">`NSConditionLock`是`NSCondition`加线程数的封装</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,2903)" ed:parentid="207" id="214" ed:width="507.1875"><text class="st23"><tspan x="10" y="16" textLength="486">`NSConditionLock`可以设置锁条件，而`NSCondition`只是无脑的通知信号</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,2936.75)" ed:parentid="123" id="216" ed:width="131.953125"><text class="st23"><tspan x="10" y="16" textLength="111">8.os_unfair_lock</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,216.2,2967.5)" ed:parentid="216" id="218" ed:width="517"><text class="st23"><tspan x="10" y="16" textLength="489">由于`OSSpinLock`自旋锁的bug，替代方案是内部封装了`os_unfair_lock`，</tspan> <tspan x="10" y="36" textLength="451">而`os_unfair_lock`在加锁时会处于休眠状态，而不是自旋锁的忙等状态</tspan></text></g> <g ed:height="40" transform="matrix(1,0,0,1,108.4,3044.5)" ed:parentid="112" id="220" ed:width="115"><path d="M4,0L111,0C113.7,0,115,1.3,115,4L115,36C115,38.7,113.7,40,111,40L4,40C1.3,40,0,38.7,0,36L0,4C0,1.3,1.3,0,4,0z" fill="#ff9595"></path> <g transform="translate(18,10.1)"><use transform="translate(0,0)" xlink:href="#imgpriority2"></use></g> <text class="st22"><tspan x="43" y="24" textLength="54">自旋锁</tspan></text></g> <symbol id="imgpriority2"><image xlink:href="data:image/png;base64,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" height="16" width="16"></image></symbol> <g ed:height="24" transform="matrix(1,0,0,1,162.3,3094.25)" ed:parentid="220" id="223" ed:width="318.1875"><text class="st23"><tspan x="10" y="16" textLength="297">线程反复检查锁变量是否可⽤，⼀种`忙等待`。</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,162.3,3128)" ed:parentid="220" id="225" ed:width="384.09375"><text class="st23"><tspan x="10" y="16" textLength="363">消耗CPU，因此对于线程只会阻塞很短时间的场合是有效的</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,162.3,3161.75)" ed:parentid="220" id="227" ed:width="203"><text class="st23"><tspan x="10" y="16" textLength="182">避免了进程上下⽂的调度开销</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,3195.5)" ed:parentid="220" id="229" ed:width="113.109375"><text class="st23"><tspan x="10" y="16" textLength="92">1.OSSpinLock</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3226.25)" ed:parentid="229" id="231" ed:width="203"><text class="st23"><tspan x="10" y="16" textLength="182">出现了安全问题之后就废弃了</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,216.2,3260)" ed:parentid="229" id="233" ed:width="517"><text class="st23"><tspan x="10" y="16" textLength="488">`OSSpinLock`忙等的机制就可能造成高优先级一直`running等待`，占用CPU</tspan> <tspan x="10" y="36" textLength="476">时间片；而低优先级任务无法抢占时间片，变成迟迟完不成，不释放锁的情况</tspan></text></g> <g ed:height="21" transform="matrix(1,0,0,1,162.3,3313.75)" ed:parentid="220" id="235" ed:width="80.078125"><text class="st23"><tspan x="10" y="16" textLength="59">2.atomic</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3344.5)" ed:parentid="235" id="237" ed:width="454.046875"><text class="st23"><tspan x="10" y="16" textLength="433">内部使用`os_unfair_lock`替代了`OSSpinLock`（iOS10之后替换）</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3378.25)" ed:parentid="235" id="239" ed:width="272.90625"><text class="st23"><tspan x="10" y="16" textLength="252">只是锁set，get方法，并完全非线程安全</tspan></text></g> <g ed:height="25" transform="matrix(1,0,0,1,216.2,3412)" ed:parentid="235" id="241" ed:width="379.1875"><path d="M4,0L375.2,0C377.9,0,379.2,1.3,379.2,4L379.2,21C379.2,23.7,377.9,25,375.2,25L4,25C1.3,25,0,23.7,0,21L0,4C0,1.3,1.3,0,4,0z" stroke="#ffabd5" stroke-width="2" stroke-linejoin="round" fill="#ffabd5"></path> <text class="st23"><tspan x="10" y="16.5" textLength="357">所以现在atomic是 基于 互斥锁 os_unfair_lock 实现的了</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,162.3,3446.75)" ed:parentid="220" id="243" ed:width="80.6875"><text class="st23"><tspan x="10" y="16" textLength="60">3. 读写锁</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3480.5)" ed:parentid="243" id="245" ed:width="430.1875"><text class="st23"><tspan x="10" y="16" textLength="409">一种特殊的`自旋锁`，它把对共享资源的访问者划分成读者和写者</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3514.25)" ed:parentid="243" id="247" ed:width="427"><text class="st23"><tspan x="10" y="16" textLength="406">读者只对共享资源进行读访问，写者则需要对共享资源进行写操作</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3548)" ed:parentid="243" id="249" ed:width="49"><text class="st23"><tspan x="10" y="16" textLength="28">写：</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,259.6,3581.75)" ed:parentid="249" id="251" ed:width="329"><text class="st23"><tspan x="10" y="16" textLength="210">获取写能力前，不能有任何读写：</tspan> <tspan x="10" y="36" textLength="308">如果已经有读操作，那么等待，直到没有读或者写</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3635.5)" ed:parentid="243" id="253" ed:width="49"><text class="st23"><tspan x="10" y="16" textLength="28">读：</tspan></text></g> <g ed:height="44" transform="matrix(1,0,0,1,259.6,3669.25)" ed:parentid="253" id="255" ed:width="259"><text class="st23"><tspan x="10" y="16" textLength="70">可以多读：</tspan> <tspan x="10" y="36" textLength="238">当前资源只有读操作，那么可以访问。</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,259.6,3723)" ed:parentid="253" id="257" ed:width="343"><text class="st23"><tspan x="10" y="16" textLength="322">当前已经有写操作，那么必须等待，直到没有写操作</tspan></text></g> <g ed:height="24" transform="matrix(1,0,0,1,216.2,3756.75)" ed:parentid="243" id="259" ed:width="254.09375"><text class="st23"><tspan x="10" y="16" textLength="233">可以使用[栅栏函数]完成读写锁的需求</tspan></text></g></svg></div> <div id="copyright">Created With  <a href="https://www.edrawsoft.com/" target="_blank" title="edrawsoft">MindMaster</a></div></div></div></body></html></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/073276/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">内存管理</div></a> <a href="/pages/2e933e/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">多线程-锁</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/073276/" class="prev">内存管理</a></span> <span class="next"><a href="/pages/2e933e/">多线程-锁</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0f5508c3.js" defer></script><script src="/assets/js/2.d54d51d6.js" defer></script><script src="/assets/js/27.d36d4f39.js" defer></script>
  </body>
</html>
