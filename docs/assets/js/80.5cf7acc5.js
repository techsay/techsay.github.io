(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{319:function(s,t,a){"use strict";a.r(t);var e=a(4),n=function(s){s.options.__data__block__={mermaid_1a962853:"graph TD\nA[源代码 main.c] --\x3e K{预处理}\nK  --预处理器--\x3e K\nK --\x3e B[产物 main.i]\n\nB --\x3e K2{编译}\nK2  --编译器--\x3e K2\nK2 --\x3e C[汇编产物 main.s ]\n\nC --\x3e K3{汇编}\nK3  --编译器--\x3e K3\nK3 --\x3e D[二进制文件 main.o ]\n\nD --\x3e K4{链接}\nK4  --链接器--\x3e K4\nK4 --\x3e E[可执行文件 main.exe main.out 等 ]\n\n"}},r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"c-程序编译过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#c-程序编译过程"}},[s._v("#")]),s._v(" C 程序编译过程")]),s._v(" "),t("h3",{attrs:{id:"整体流程概况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#整体流程概况"}},[s._v("#")]),s._v(" 整体流程概况")]),s._v(" "),t("p",[s._v("源程序(.c) → 预处理 → 编译 → 汇编 → 链接")]),s._v(" "),t("Mermaid",{attrs:{id:"mermaid_1a962853",graph:s.$dataBlock.mermaid_1a962853}}),t("p",[s._v("源代码：hello.c")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello World!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 打印 Hello World")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("终端执行命令（MacOS）：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nhello.c\n$ gcc -save-temps hello.c "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" hello\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nhello\thello.c\t\thello.o\nhello.bc\thello.i\t\thello.s\n")])])]),t("p",[s._v("其中产物分别为（MacOS）：")]),s._v(" "),t("div",{staticClass:"language-scss extra-class"},[t("pre",{pre:!0,attrs:{class:"language-scss"}},[t("code",[s._v("- hello.i 预处理器产生的文件\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" hello.s 编译器编译后产生的文件\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" hello.o 汇编程序翻译后的目标文件\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" hello.bc LLVM 编译器在编译过程中产生的中间代码（IR），最后将.bc文件转为可执行文件（有些平台可能没有）\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" hello 可执行文件，后缀名可以根据系统设置"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("windows 产物hello.exe， Linux系统会产生hello.out文件"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("h3",{attrs:{id:"_1-预处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-预处理"}},[s._v("#")]),s._v(" "),t("strong",[s._v("1.预处理")])]),s._v(" "),t("p",[s._v("预处理操作")]),s._v(" "),t("blockquote",[t("p",[s._v("✦ 将所有的define 内容进行替换，然后删除define定义")]),s._v(" "),t("p",[s._v("✦ 处理条件编译指令 #if, #ifdef, #ifudef等，替换成满足条件的代码，其余删除")]),s._v(" "),t("p",[s._v("✦ 将#include 指向的头文件内容复制并插入到该行，替换#include 所在行")]),s._v(" "),t("p",[s._v("✦ 删除所有注释，保留#pragma编译指令")]),s._v(" "),t("p",[s._v("✦ 添加代码行号和文件位置标示")]),s._v(" "),t("p",[s._v("✦ 最终产物 .i 文件")])]),s._v(" "),t("p",[s._v("单步骤预处理命令：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-E")]),s._v(" hello.c "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" hello.i\n")])])]),t("p",[s._v("产物 hello.i")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 前面省略，直接拉到文件最尾部代码")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extern")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__vsnprintf_chk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" restrict"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("size_t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("size_t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" restrict"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" va_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n# "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdio.h"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n# "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello.c"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello World!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("可以看到:")]),s._v(" "),t("blockquote",[t("p",[s._v("stdio.h 引用被替换成了真实路径\n注射内容被删除了\n还可以写其他代码试试")])]),s._v(" "),t("h3",{attrs:{id:"_2-编译"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-编译"}},[s._v("#")]),s._v(" "),t("strong",[s._v("2.编译")])]),s._v(" "),t("p",[s._v("编译：将c语言翻译为汇编语言")]),s._v(" "),t("blockquote",[t("p",[s._v("✦ 词法分析")]),s._v(" "),t("p",[s._v("（是编译过程的第一个阶段，词法分析的任务是一个字符一个字符地读入源码，把字符序列转化为单词（token）序列）")]),s._v(" "),t("p",[s._v("✦ 语法分析")]),s._v(" "),t("p",[s._v("（任务是在词法分析的基础上将单词组合成各种“句子”（AST），有了“句子”计算机才能知道程序的含义）")]),s._v(" "),t("p",[s._v("✦ 语义分析")]),s._v(" "),t("p",[s._v("（任务是进行类型检查，类型推导，隐式类型转换，常量表达式计算，运算符重载和函数重载。）")]),s._v(" "),t("p",[s._v("✦ 优化后生成相应的汇编代码. 从 "),t("strong",[s._v("高级语言")]),s._v(" → 低级"),t("strong",[s._v("汇编语言")]),s._v(" 产物 .s")])]),s._v(" "),t("p",[s._v("单步骤生成汇编代码：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-S")]),s._v(" hello.i "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" hello.s\n")])])]),t("p",[s._v("产物 hello.s (MacOS M1)")]),s._v(" "),t("div",{staticClass:"language-assembly extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('\t.section\t__TEXT,__text,regular,pure_instructions\n\t.build_version macos, 12, 0\tsdk_version 12, 1\n\t.globl\t_main                           ## -- Begin function main\n\t.p2align\t4, 0x90\n_main:                                  ## @main\n\t.cfi_startproc\n## %bb.0:\n\tpushq\t%rbp\n\t.cfi_def_cfa_offset 16\n\t.cfi_offset %rbp, -16\n\tmovq\t%rsp, %rbp\n\t.cfi_def_cfa_register %rbp\n\tsubq\t$16, %rsp\n\tmovl\t$0, -4(%rbp)\n\tleaq\tL_.str(%rip), %rdi\n\tmovb\t$0, %al\n\tcallq\t_printf\n\txorl\t%eax, %eax\n\taddq\t$16, %rsp\n\tpopq\t%rbp\n\tretq\n\t.cfi_endproc\n                                        ## -- End function\n\t.section\t__TEXT,__cstring,cstring_literals\nL_.str:                                 ## @.str\n\t.asciz\t"Hello World!"\n\n.subsections_via_symbols\n\n')])])]),t("h3",{attrs:{id:"_3-汇编"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-汇编"}},[s._v("#")]),s._v(" "),t("strong",[s._v("3.汇编")])]),s._v(" "),t("p",[s._v("汇编就是将汇编语言(指令集) 转成机器语言")]),s._v(" "),t("p",[s._v("汇编语言 → 机器语言 ("),t("strong",[s._v("二进制")]),s._v(")")]),s._v(" "),t("p",[s._v("编译.s 至目标文件 .o ：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" hello.s "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" hello.o\n")])])]),t("p",[s._v("产物 hello.o")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v("cffa edfe "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0700")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0001")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0300")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0400")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0802")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0020")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1900")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8801")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9800")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2802")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 中间省略...")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0041")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0e10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8602")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("430")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0600")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1900")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("002")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1200")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0200")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0015")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0006")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0f")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0700")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("005f")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("d61 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("696")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("005f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7072")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("696")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7466")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" \n")])])]),t("h3",{attrs:{id:"_4-链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-链接"}},[s._v("#")]),s._v(" "),t("strong",[s._v("4.链接")])]),s._v(" "),t("p",[s._v("链接的作用如下：")]),s._v(" "),t("blockquote",[t("p",[s._v("✦ 当源程序很大时，可以将它分为多个源程序，通过编译可以形成 "),t("strong",[s._v("多个目标文件(Unix: .o)")]),s._v("，这时我们需要用链接器把它们连接到一起，生成一个可执行文件；")]),s._v(" "),t("p",[s._v("✦ 程序中调用了某个库文件中的子程序, 需要将这个库文件和该程序生成的目标文件连接到一起，生成一个可执行文件；")]),s._v(" "),t("p",[s._v("链接器把多个二进制的目标文件（object file）链接成一个单独的可执行文件。在链接过程中，它必须把符号（变量名、函数名等一些列标识符）用对应的数据的内存地址（变量地址、函数地址等）替代，以完成程序中多个模块的外部引用。（静态链接和动态链接）")]),s._v(" "),t("p",[s._v("通过编译器的前3个步骤后，我们获得目标代码，但是里面的各个地址还没有确定，空间还没有分配。链接过程主要包括：地址和空间的分配，符号决议和重定位。")]),s._v(" "),t("p",[s._v("✦ 一个源程序编译后，得到了存有机器码的目标文件，目标文件中的有些内容还不能直接用来生成可执行文件，链接器程序将这些内容处理为最终的可执行信息. 所以，在只有一个源程序文件，而又不需要调用某个库中的子程序时，也必须用链接器对目标文件进行处理，生成可执行文件.")])]),s._v(" "),t("p",[s._v("链接操作：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc hello.o "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" hello\n\n如果是Windows可以添加文件后缀：\ngcc hello.o "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" hello.exe\n")])])]),t("p",[s._v("那么hello 就是最后的可执行文件")]),s._v(" "),t("p",[s._v("那么我们通过MachOView 来查看可执行文件结构：")]),s._v(" "),t("img",{attrs:{src:s.$withBase("/images/C/hellofilestring.png"),alt:"hello"}}),s._v(" "),t("p",[s._v("上图在 TEXT 的 string 段发现我们源代码需要输出的字符串 “Hello World!”")]),s._v(" "),t("h3",{attrs:{id:"运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行"}},[s._v("#")]),s._v(" "),t("strong",[s._v("运行")])]),s._v(" "),t("p",[s._v("Macos 运行可执行文件 hello  (可执行文件)")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ ./hello\nHello World"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])])]),t("h3",{attrs:{id:"附表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#附表"}},[s._v("#")]),s._v(" 附表")]),s._v(" "),t("p",[s._v("GCC常用的编译选项")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("gcc/g++指令选项")]),s._v(" "),t("th",[s._v("功 能")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("-E（大写）")]),s._v(" "),t("td",[s._v("预处理指定的源文件，不进行编译。")])]),s._v(" "),t("tr",[t("td",[s._v("-S（大写）")]),s._v(" "),t("td",[s._v("编译指定的源文件，但是不进行汇编。")])]),s._v(" "),t("tr",[t("td",[s._v("-c")]),s._v(" "),t("td",[s._v("编译、汇编指定的源文件，但是不进行链接。")])]),s._v(" "),t("tr",[t("td",[s._v("-o")]),s._v(" "),t("td",[s._v("指定生成文件的文件名。")])])])])],1)}),[],!1,null,null,null);"function"==typeof n&&n(r);t.default=r.exports}}]);